CREATE OR REPLACE FUNCTION SF_GET_JOB_COUNT(P_EMPID NUMBER) RETURN NUMBER AS

V_COUNT1 NUMBER(3);
V_COUNT2 NUMBER(3);
INVALID_EMPLOYEE EXCEPTION; 

TABLE JOB_ID IS TABLE OF TYPE EMPLOYEES.JOB_ID%TYPE INDEX BY BINARY_INTEGER;
BEGIN 

SELECT COUNT(EMPLOYEE_ID) INTO V_COUNT2 FROM EMPLOYEES WHERE EMPLOYEE_ID=P_EMPID;

IF V_COUNT2=0 THEN RAISE
INVALID_EMPLOYEE;

ELSE

SELECT COUNT(EMPLOYEE_ID) INTO V_COUNT1 FROM JOB_HISTORY WHERE EMPLOYEE_ID=P_EMPID;
RETURN V_COUNT1;

END IF;



EXCEPTION
WHEN INVALID_EMPLOYEE THEN
DBMS_OUTPUT.PUT_LINE('ERR - 2001,EMPLOYEE DOES NOT EXIST'); 
END;
/
SHOW ERRORS;